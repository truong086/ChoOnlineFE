<template>
  <!-- Header -->
  <header class="header shop">
    <!-- Topbar -->
    <div class="topbar">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 col-md-12 col-12">
            <!-- Top Left -->
            <div class="top-left">
              <ul class="list-main">
                <li><i class="ti-headphone-alt"></i> +060 (800) 801-582</li>
                <li><i class="ti-email"></i> support@shophub.com</li>
              </ul>
            </div>
            <!--/ End Top Left -->
          </div>
          <div class="col-lg-8 col-md-12 col-12">
            <!-- Top Right -->
            <div class="right-content">
              <ul class="list-main">
                <li><i class="ti-location-pin"></i> Store location</li>
                <li>
                  <i class="ti-alarm-clock"></i> <a href="#">Daily deal</a>
                </li>
                <li><i class="ti-user"></i> <a href="#">My account</a></li>
                <li>
                  <i class="ti-power-off"></i><a href="login.html#">Login</a>
                </li>
              </ul>
            </div>
            <!-- End Top Right -->
          </div>
        </div>
      </div>
    </div>
    <!-- End Topbar -->
    <div class="middle-inner">
      <div class="container">
        <div class="row">
          <div class="col-lg-2 col-md-2 col-12">
            <!-- Logo -->
            <div class="logo">
              <a href="index.html"><img src="images/logo.png" alt="logo" /></a>
            </div>
            <!--/ End Logo -->
            <!-- Search Form -->
            <div class="search-top">
              <div class="top-search">
                <a href="#0"><i class="ti-search"></i></a>
              </div>
              <!-- Search Form -->
              <div class="search-top">
                <form class="search-form">
                  <input
                    type="text"
                    placeholder="Search here..."
                    name="search"
                  />
                  <button value="search" type="submit">
                    <i class="ti-search"></i>
                  </button>
                </form>
              </div>
              <!--/ End Search Form -->
            </div>
            <!--/ End Search Form -->
            <div class="mobile-nav"></div>
          </div>
          <div class="col-lg-8 col-md-7 col-12">
            <div class="search-bar-top">
              <div class="search-bar">
                <select>
                  <option selected="selected">All Category</option>
                  <option>watch</option>
                  <option>mobile</option>
                  <option>kid’s item</option>
                </select>
                <form>
                  <input
                    name="search"
                    placeholder="Search Products Here....."
                    type="search"
                  />
                  <button class="btnn"><i class="ti-search"></i></button>
                </form>
              </div>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-12">
            <div class="right-bar">
              <!-- Search Form -->
              <div class="sinlge-bar">
                <a href="#" class="single-icon"
                  ><i class="fa fa-heart-o" aria-hidden="true"></i
                ></a>
              </div>
              <div class="sinlge-bar">
                <a href="#" class="single-icon"
                  ><i class="fa fa-user-circle-o" aria-hidden="true"></i
                ></a>
              </div>
              <div class="sinlge-bar shopping">
                <a href="#" class="single-icon"
                  ><i class="ti-bag"></i> <span class="total-count">2</span></a
                >
                <!-- Shopping Item -->
                <div class="shopping-item">
                  <div class="dropdown-cart-header">
                    <span>2 Items</span>
                    <a href="#">View Cart</a>
                  </div>
                  <ul class="shopping-list">
                    <li>
                      <a href="#" class="remove" title="Remove this item"
                        ><i class="fa fa-remove"></i
                      ></a>
                      <a class="cart-img" href="#"
                        ><img src="https://via.placeholder.com/70x70" alt="#"
                      /></a>
                      <h4><a href="#">Woman Ring</a></h4>
                      <p class="quantity">
                        1x - <span class="amount">$99.00</span>
                      </p>
                    </li>
                    <li>
                      <a href="#" class="remove" title="Remove this item"
                        ><i class="fa fa-remove"></i
                      ></a>
                      <a class="cart-img" href="#"
                        ><img src="https://via.placeholder.com/70x70" alt="#"
                      /></a>
                      <h4><a href="#">Woman Necklace</a></h4>
                      <p class="quantity">
                        1x - <span class="amount">$35.00</span>
                      </p>
                    </li>
                  </ul>
                  <div class="bottom">
                    <div class="total">
                      <span>Total</span>
                      <span class="total-amount">$134.00</span>
                    </div>
                    <a href="checkout.html" class="btn animate">Checkout</a>
                  </div>
                </div>
                <!--/ End Shopping Item -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Header Inner -->
    <div class="header-inner">
      <div class="container">
        <div class="cat-nav-head">
          <div class="row">
            <div class="col-12">
              <div class="menu-area">
                <!-- Main Menu -->
                <nav class="navbar navbar-expand-lg">
                  <div class="navbar-collapse">
                    <div class="nav-inner">
                      <ul class="nav main-menu menu navbar-nav">
                        <li class="active"><a href="#">Home</a></li>
                        <li><a href="#">Product</a></li>
                        <li><a href="#">Service</a></li>
                        <li>
                          <a href="#"
                            >Shop<i class="ti-angle-down"></i
                            ><span class="new">New</span></a
                          >
                          <ul class="dropdown">
                            <li><a href="shop-grid.html">Shop Grid</a></li>
                            <li><a href="cart.html">Cart</a></li>
                            <li><a href="checkout.html">Checkout</a></li>
                          </ul>
                        </li>
                        <li><a href="#">Pages</a></li>
                        <li>
                          <a href="#">Blog<i class="ti-angle-down"></i></a>
                          <ul class="dropdown">
                            <li>
                              <a href="blog-single-sidebar.html"
                                >Blog Single Sidebar</a
                              >
                            </li>
                          </ul>
                        </li>
                        <li><a href="contact.html">Contact Us</a></li>
                      </ul>
                    </div>
                  </div>
                </nav>
                <!--/ End Main Menu -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/ End Header Inner -->
  </header>
  <!--/ End Header -->

  <!-- Breadcrumbs -->
  <div class="breadcrumbs">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="bread-inner">
            <ul class="bread-list">
              <li>
                <a href="index1.html">Home<i class="ti-arrow-right"></i></a>
              </li>
              <li class="active"><a href="blog-single.html">Cart</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- End Breadcrumbs -->

  <!-- Shopping Cart -->
  <div class="shopping-cart section">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <!-- Shopping Summery -->
          <table class="table shopping-summery">
            <thead>
              <tr class="main-hading">
                <th>PRODUCT</th>
                <th>NAME</th>
                <th class="text-center">UNIT PRICE</th>
                <th class="text-center">QUANTITY</th>
                <th class="text-center">TOTAL</th>
                <th class="text-center">
                  <i class="ti-trash remove-icon"></i>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(item, index) in dataCart" :key="index">
                <td class="image" data-title="No">
                  <label>
                    <!-- <input type="checkbox" :value="item.product_id" @change="toggleProductSelection(item.product_id)"> -->
                    <input type="checkbox" :value="item.product_id" @change="toggleProductSelection(item)">
                  </label>
                </td>
                <td class="image" data-title="No">
                  <img :src="item.image" alt="#" />
                </td>
                <td class="product-des" data-title="Description">
                  <p class="product-name"><a href="#">Sản phẩm</a></p>
                  <p class="product-des">
                    {{ item.product_name }}
                  </p>
                </td>
                <td class="price" data-title="Price"><span>${{ item.price }} </span></td>
                <td class="qty" data-title="Qty">
                  <!-- Input Order -->
                  <div class="input-group">
                    <div class="button minus">
                      <button
                        type="button"
                        class="btn btn-primary btn-number"
                        data-type="minus"
                        data-field="quant[1]"
                        v-on:click="TangGiam('giam', item.product_id, item.price)"
                      >
                        <i class="ti-minus"></i>
                      </button>
                    </div>
                    <input
                      type="text"
                      name="quant[1]"
                      class="input-number"
                      data-min="1"
                      data-max="100"
                      :value="item.soluong"
                    />
                    <div class="button plus">
                      <button
                        type="button"
                        class="btn btn-primary btn-number"
                        data-type="plus"
                        data-field="quant[1]"
                        v-on:click="TangGiam('tang', item.product_id, item.price)"
                      >
                        <i class="ti-plus"></i>
                      </button>
                    </div>
                  </div>
                  <!--/ End Input Order -->
                </td>
                <td class="total-amount" data-title="Total">
                  <span>${{ item.total }}</span>
                </td>
                <td class="action" data-title="Remove">
                  <a href="#" @click="Delete(item.product_id)"><i class="ti-trash remove-icon"></i></a>
                </td>
              </tr>
            </tbody>
          </table>
          <!--/ End Shopping Summery -->
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <!-- Total Amount -->
          <div class="total-amount">
            <div class="row">
              <div class="col-lg-8 col-md-5 col-12">
                <div class="left">
                  <div class="coupon">
                    <div>
                        <div style="width: 220px;"><h3 style="font-size: 15px;">Chọn phương thức thanh toán</h3></div>
                        <div style="width: 120px; ">
                          <label>
                            <input type="checkbox" :checked="isChecked(1)" @change="thanhToanOnline('momo', 1)"/>
                            Momo
                          </label>
                          <label>
                            <input type="checkbox" :checked="isChecked(2)" @change="thanhToanOnline('vnpay', 2)"/>
                            VnPay
                          </label>
                          <label>
                            <input type="checkbox" :checked="isChecked(3)" @change="thanhToanOnline('zalopay', 3)"/>
                            Zalo Pay
                          </label>
                          
                        </div>
                      </div>
                    <form action="#" target="_blank">
                      <input name="Coupon" placeholder="Enter Your Coupon" />
                      
                      <button class="btn" type="button" @click="ThanhToan">Apply</button>
                    </form>
                  </div>
                  <div class="checkbox">
                    <label class="checkbox-inline" for="2"
                      ><input name="news" id="2" type="checkbox" /> Shipping
                      (+10$)</label
                    >
                  </div>
                </div>
              </div>
              <div class="col-lg-4 col-md-7 col-12">
                <div class="right">
                  <ul>
                    <li>Cart Subtotal<span>$330.00</span></li>
                    <li>Shipping<span>Free</span></li>
                    <li>You Save<span>$20.00</span></li>
                    <li class="last">You Pay<span>${{ TotalMoney() }}</span></li>
                  </ul>
                  <div class="button5">
                    <a href="#" class="btn">Checkout</a>
                    <a href="#" class="btn">Continue shopping</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--/ End Total Amount -->
        </div>
      </div>
    </div>
  </div>
  <!--/ End Shopping Cart -->

  <!-- Start Shop Services Area  -->
  <section class="shop-services section">
    <div class="container">
      <div class="row">
        <div class="col-lg-3 col-md-6 col-12">
          <!-- Start Single Service -->
          <div class="single-service">
            <i class="ti-rocket"></i>
            <h4>Free shiping</h4>
            <p>Orders over $100</p>
          </div>
          <!-- End Single Service -->
        </div>
        <div class="col-lg-3 col-md-6 col-12">
          <!-- Start Single Service -->
          <div class="single-service">
            <i class="ti-reload"></i>
            <h4>Free Return</h4>
            <p>Within 30 days returns</p>
          </div>
          <!-- End Single Service -->
        </div>
        <div class="col-lg-3 col-md-6 col-12">
          <!-- Start Single Service -->
          <div class="single-service">
            <i class="ti-lock"></i>
            <h4>Sucure Payment</h4>
            <p>100% secure payment</p>
          </div>
          <!-- End Single Service -->
        </div>
        <div class="col-lg-3 col-md-6 col-12">
          <!-- Start Single Service -->
          <div class="single-service">
            <i class="ti-tag"></i>
            <h4>Best Peice</h4>
            <p>Guaranteed price</p>
          </div>
          <!-- End Single Service -->
        </div>
      </div>
    </div>
  </section>
  <!-- End Shop Newsletter -->

  <!-- Start Shop Newsletter  -->
  <section class="shop-newsletter section">
    <div class="container">
      <div class="inner-top">
        <div class="row">
          <div class="col-lg-8 offset-lg-2 col-12">
            <!-- Start Newsletter Inner -->
            <div class="inner">
              <h4>Newsletter</h4>
              <p>
                Subscribe to our newsletter and get <span>10%</span> off your
                first purchase
              </p>
              <form
                action="mail/mail.php"
                method="get"
                target="_blank"
                class="newsletter-inner"
              >
                <input
                  name="EMAIL"
                  placeholder="Your email address"
                  required=""
                  type="email"
                />
                <button class="btn">Subscribe</button>
              </form>
            </div>
            <!-- End Newsletter Inner -->
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- End Shop Newsletter -->

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span class="ti-close" aria-hidden="true"></span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row no-gutters">
            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
              <!-- Product Slider -->
              <div class="product-gallery">
                <div class="quickview-slider-active">
                  <div class="single-slider">
                    <img src="images/modal1.jpg" alt="#" />
                  </div>
                  <div class="single-slider">
                    <img src="images/modal2.jpg" alt="#" />
                  </div>
                  <div class="single-slider">
                    <img src="images/modal3.jpg" alt="#" />
                  </div>
                  <div class="single-slider">
                    <img src="images/modal4.jpg" alt="#" />
                  </div>
                </div>
              </div>
              <!-- End Product slider -->
            </div>
            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
              <div class="quickview-content">
                <h2>Flared Shift Dress</h2>
                <div class="quickview-ratting-review">
                  <div class="quickview-ratting-wrap">
                    <div class="quickview-ratting">
                      <i class="yellow fa fa-star"></i>
                      <i class="yellow fa fa-star"></i>
                      <i class="yellow fa fa-star"></i>
                      <i class="yellow fa fa-star"></i>
                      <i class="fa fa-star"></i>
                    </div>
                    <a href="#"> (1 customer review)</a>
                  </div>
                  <div class="quickview-stock">
                    <span><i class="fa fa-check-circle-o"></i> in stock</span>
                  </div>
                </div>
                <h3>$29.00</h3>
                <div class="quickview-peragraph">
                  <p>
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                    Mollitia iste laborum ad impedit pariatur esse optio tempora
                    sint ullam autem deleniti nam in quos qui nemo ipsum
                    numquam.
                  </p>
                </div>
                <div class="size">
                  <div class="row">
                    <div class="col-lg-6 col-12">
                      <h5 class="title">Size</h5>
                      <select>
                        <option selected="selected">s</option>
                        <option>m</option>
                        <option>l</option>
                        <option>xl</option>
                      </select>
                    </div>
                    <div class="col-lg-6 col-12">
                      <h5 class="title">Color</h5>
                      <select>
                        <option selected="selected">orange</option>
                        <option>purple</option>
                        <option>black</option>
                        <option>pink</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="quantity">
                  <!-- Input Order -->
                  <div class="input-group">
                    <div class="button minus">
                      <button
                        type="button"
                        class="btn btn-primary btn-number"
                        disabled="disabled"
                        data-type="minus"
                        data-field="quant[1]"
                      >
                        <i class="ti-minus"></i>
                      </button>
                    </div>
                    <input
                      type="text"
                      name="quant[1]"
                      class="input-number"
                      data-min="1"
                      data-max="1000"
                      value="1"
                    />
                    <div class="button plus">
                      <button
                        type="button"
                        class="btn btn-primary btn-number"
                        data-type="plus"
                        data-field="quant[1]"
                      >
                        <i class="ti-plus"></i>
                      </button>
                    </div>
                  </div>
                  <!--/ End Input Order -->
                </div>
                <div class="add-to-cart">
                  <a href="#" class="btn">Add to cart</a>
                  <a href="#" class="btn min"><i class="ti-heart"></i></a>
                  <a href="#" class="btn min"><i class="fa fa-compress"></i></a>
                </div>
                <div class="default-social">
                  <h4 class="share-now">Share:</h4>
                  <ul>
                    <li>
                      <a class="facebook" href="#"
                        ><i class="fa fa-facebook"></i
                      ></a>
                    </li>
                    <li>
                      <a class="twitter" href="#"
                        ><i class="fa fa-twitter"></i
                      ></a>
                    </li>
                    <li>
                      <a class="youtube" href="#"
                        ><i class="fa fa-pinterest-p"></i
                      ></a>
                    </li>
                    <li>
                      <a class="dribbble" href="#"
                        ><i class="fa fa-google-plus"></i
                      ></a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal end -->

  <!-- Start Footer Area -->
  <footer class="footer">
    <!-- Footer Top -->
    <div class="footer-top section">
      <div class="container">
        <div class="row">
          <div class="col-lg-5 col-md-6 col-12">
            <!-- Single Widget -->
            <div class="single-footer about">
              <div class="logo">
                <a href="index.html"><img src="images/logo2.png" alt="#" /></a>
              </div>
              <p class="text">
                Praesent dapibus, neque id cursus ucibus, tortor neque egestas
                augue, magna eros eu erat. Aliquam erat volutpat. Nam dui mi,
                tincidunt quis, accumsan porttitor, facilisis luctus, metus.
              </p>
              <p class="call">
                Got Question? Call us 24/7<span
                  ><a href="tel:123456789">+0123 456 789</a></span
                >
              </p>
            </div>
            <!-- End Single Widget -->
          </div>
          <div class="col-lg-2 col-md-6 col-12">
            <!-- Single Widget -->
            <div class="single-footer links">
              <h4>Information</h4>
              <ul>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Faq</a></li>
                <li><a href="#">Terms & Conditions</a></li>
                <li><a href="#">Contact Us</a></li>
                <li><a href="#">Help</a></li>
              </ul>
            </div>
            <!-- End Single Widget -->
          </div>
          <div class="col-lg-2 col-md-6 col-12">
            <!-- Single Widget -->
            <div class="single-footer links">
              <h4>Customer Service</h4>
              <ul>
                <li><a href="#">Payment Methods</a></li>
                <li><a href="#">Money-back</a></li>
                <li><a href="#">Returns</a></li>
                <li><a href="#">Shipping</a></li>
                <li><a href="#">Privacy Policy</a></li>
              </ul>
            </div>
            <!-- End Single Widget -->
          </div>
          <div class="col-lg-3 col-md-6 col-12">
            <!-- Single Widget -->
            <div class="single-footer social">
              <h4>Get In Tuch</h4>
              <!-- Single Widget -->
              <div class="contact">
                <ul>
                  <li>NO. 342 - London Oxford Street.</li>
                  <li>012 United Kingdom.</li>
                  <li>info@eshop.com</li>
                  <li>+032 3456 7890</li>
                </ul>
              </div>
              <!-- End Single Widget -->
              <ul>
                <li>
                  <a href="#"><i class="ti-facebook"></i></a>
                </li>
                <li>
                  <a href="#"><i class="ti-twitter"></i></a>
                </li>
                <li>
                  <a href="#"><i class="ti-flickr"></i></a>
                </li>
                <li>
                  <a href="#"><i class="ti-instagram"></i></a>
                </li>
              </ul>
            </div>
            <!-- End Single Widget -->
          </div>
        </div>
      </div>
    </div>
    <!-- End Footer Top -->
    <div class="copyright">
      <div class="container">
        <div class="inner">
          <div class="row">
            <div class="col-lg-6 col-12">
              <div class="left">
                <p>
                  Copyright © 2020
                  <a href="http://www.wpthemesgrid.com" target="_blank"
                    >Wpthemesgrid</a
                  >
                  - All Rights Reserved.
                </p>
              </div>
            </div>
            <div class="col-lg-6 col-12">
              <div class="right">
                <img src="images/payments.png" alt="#" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- /End Footer Area -->
</template>

<script>
import axios from 'axios'
import Swal from 'sweetalert2';
import moment from 'moment';
  export default{
    data(){
      return{
        dataCart: [],
        selectedProductIds: [], // Mảng lưu trữ ID của các sản phẩm được chọn từ ô checkbox
        checkBox: null, // chỉ số của checkbox được chọn
        nganhang: "",
        createPayment: {
          paymentContent: "",
          paymentCurrency: "",
          paymentRefId: 0,
          paymentAmount: 0.0,
          paymentDate: null,
          expireDate: null,
          paymentLanguage: "",
          merchantId: 0,
          paymentDestinationId: 0,
          signature: ""


        }
      }
    },
    mounted() {
      
    },
    created() {
      this.TotalMoney()
      const cart = JSON.parse(localStorage.getItem('cart')) || []
      this.dataCart = cart
      console.log(this.dataCart)
    },
    methods: {
    thanhToanOnline(type, index){
      if(this.checkBox === index){
          this.checkBox = null // Bỏ chọn checkbox nếu nó đã được chọn trước đó
        }else{
          this.checkBox = index // Chọn checkbox mới
        }
        this.nganhang = type
      console.log(type)
    },
    isChecked(index){
      return this.checkBox === index
    }
    ,
    toggleCheckbox(index){
        if(this.checkBox === index){
          this.checkBox = null
        }else{
          this.checkBox = index
        }
    }
    ,
      TangGiam(type, id, price){
        const giohang = JSON.parse(localStorage.getItem('cart')) || []
        const findId = giohang.find(x => x.product_id === id)
        if(type === 'tang'){
          if(findId){
            findId.soluong += 1
            findId.total = Math.round(findId.soluong * price)
            localStorage.setItem('cart', JSON.stringify(giohang))
            this.dataCart = giohang
          }
          
        }else if(type === 'giam'){
          if(findId){
            if(findId.soluong > 1){
              findId.soluong -= 1
              findId.total = Math.round(findId.soluong * findId.price)
              localStorage.setItem('cart', JSON.stringify(giohang))
              this.dataCart = giohang
            }else{
              this.$notify({
                title: "Thông báo",
                text: "Phải có  ít nhất 1 sản phẩm",
                // Hiển thị thông báo trong khoảng thời gian còn lại
                duration: 5000,
                type: "error"
            });
            }
            
          }
          
        }
      },
      getTokenConfig(){
            var token = JSON.parse(localStorage.getItem("token"))
            // var token = JSON.parse(store.state.authToken)
            var result = {
                headers: {Authorization: `Bearer ${token}`}
            }
            console.log(token)
            return result
        },
      async ThanhToan(){
        this.createPayment.paymentDate = moment()
          this.createPayment.expireDate = moment()
        if(this.selectedProductIds.length === 0){
          this.$notify({
            title: "Thông báo",
            text: "Bạn chưa chọn đơn hàng",
            // Hiển thị thông báo trong khoảng thời gian còn lại
            duration: 5000,
            type: "warn"
          });

          return
        }

        // let sum

        // this.selectedProductIds.map(item => {
        //   sum = sum + item.total
        // })

        // if(this.nganhang === "zalopay"){

        // }
        // if(this.nganhang === "vnpay"){

        // }



        if(this.nganhang === ""){
          await axios.post(this.hostname + `/api/Order/AddDonHangXuLy`, this.selectedProductIds, this.getTokenConfig())
        .then((response) => {
          /* phương thức "filter()" để tạo một mảng mới "updateCart" từ mảng "dataCart" (chứa dữ liệu giỏ hàng) bằng cách loại bỏ
           các sản phẩm có ID nằm trong danh sách "this.selectedProductIds". */
           // ".filter()": Là một phương thức của mảng trong JavaScript, cho phép tạo một mảng mới từ mảng ban đầu dựa trên một điều kiện xác định.
          const updateCart = this.dataCart.filter(item => !this.selectedProductIds.includes(item))
          // GIẢI THÍCH ĐOẠN CODE: "item => !this.selectedProductIds.includes(item)"
          /**
           * item => !this.selectedProductIds.includes(item): Đây là một hàm callback được truyền vào "filter()". Đối với mỗi phần tử
           *  "item" trong "this.dataCart", hàm này kiểm tra xem "item" có nằm trong danh sách "this.selectedProductIds" không. 
           *  Nếu không nằm trong danh sách, điều kiện "!this.selectedProductIds.includes(product.id)" trả về true, do đó, filter() giữ lại 
           *  "item" trong mảng kết quả.
           */
          this.dataCart = updateCart
          localStorage.setItem('cart', JSON.stringify(updateCart))
          this.selectedProductIds = []
          this.$notify({
            title: "Thông báo",
            text: "Đang đợi xét duyệt đơn hàng",
            // Hiển thị thông báo trong khoảng thời gian còn lại
            duration: 5000,
            type: "success"
          });
          
          
          console.log(response)

        })
        .catch(error => {
          if(error.response){
            Swal.fire(error.response.data)
          }
        })
        }
        else if(this.nganhang === "zalopay"){
          console.log("Đã vào")
          this.createPayment.paymentContent = "Thanh toán Online"
          this.createPayment.paymentCurrency = "VND"
          this.createPayment.paymentRefId = 1
          this.createPayment.paymentAmount = this.TotalMoney()
          this.createPayment.paymentDate.format()
          this.createPayment.expireDate.format()
          this.createPayment.paymentLanguage = "vn"
          this.createPayment.merchantId = 3
          this.createPayment.paymentDestinationId = 2
          this.createPayment.signature = "qwerty"


          await axios.post(this.hostname + "/api/Payments/Create", this.createPayment)
          .then(response => {
            // this.$router.push(response.data.data.paymentUrl)
            window.location.href = `${response.data.data.paymentUrl}`
            // console.log(response)
          })
          .catch(error => {
            if(error.response){
              Swal.fire(error.response.data)
            }
          })
        }else if(this.nganhang === "vnpay"){

        /**
         * {
  {
  "paymentContent": "string",
  "paymentCurrency": "VND",
  "paymentRefId": 1,
  "paymentAmount": 106000,
  "paymentDate": "2024-07-01T14:25:29.980Z",
  "expireDate": "2024-07-01T14:25:29.980Z",
  "paymentLanguage": "vn",
  "merchantId": 3,
  "paymentDestinationId": 1,
  "signature": "string"

  07/15
  NGUYEN VAN A
  9704198526191432198
}
}
         */
          console.log("Đã vào")
          this.createPayment.paymentContent = "Thanh toán Online"
          this.createPayment.paymentCurrency = "VND"
          this.createPayment.paymentRefId = 1
          this.createPayment.paymentAmount = this.TotalMoney()
          this.createPayment.paymentDate.format()
          this.createPayment.expireDate.format()
          this.createPayment.paymentLanguage = "vn"
          this.createPayment.merchantId = 3
          this.createPayment.paymentDestinationId = 1
          this.createPayment.signature = "qwerty"


          await axios.post(this.hostname + "/api/Payments/Create", this.createPayment)
          .then(response => {
            // this.$router.push(response.data.data.paymentUrl)
            window.location.href = `${response.data.data.paymentUrl}`
            // console.log(response)
          })
          .catch(error => {
            if(error.response){
              Swal.fire(error.response.data)
            }
          })
        }
        
      },
      TotalMoney(){
        const cart = JSON.parse(localStorage.getItem('cart')) || []
        let sum = 0
        cart.map(item => {
          sum = sum + (item.soluong * item.price)
        })
        console.log(sum)
        return sum
      }
      ,
      Delete(id){
        console.log(id)
        const cartList = JSON.parse(localStorage.getItem('cart')) || []
        const checkItem = cartList.filter(item  => item.product_id !== id)
        this.dataCart = checkItem
        localStorage.setItem('cart', JSON.stringify(checkItem))

      },
      toggleProductSelection(productId) {
      // Kiểm tra xem sản phẩm đã được chọn hay chưa
      // const index = this.selectedProductIds.indexOf(productId.account_id);
      const index = this.selectedProductIds.indexOf(productId);
      
      if (index === -1) {
        // Nếu chưa có trong danh sách được chọn, thêm vào mảng selectedProductIds
        this.selectedProductIds.push(productId);
      } else {
        // Nếu đã có trong danh sách được chọn, loại bỏ khỏi mảng selectedProductIds
        this.selectedProductIds.splice(index, 1);
      }

      console.log(this.selectedProductIds)
    },
    },
  }
</script>

<style scoped></style>
